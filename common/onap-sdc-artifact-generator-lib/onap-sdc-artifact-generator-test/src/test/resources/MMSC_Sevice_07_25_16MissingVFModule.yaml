tosca_definitions_version: tosca_simple_profile_for_ecomp_1_0

description: vMMSC Service Topology Template

metadata:
  invariantUUID: e255f20c-5331-4245-9ad5-8861a73080b7
  UUID: 7787da18-7516-40cf-bec0-ebd4202c60f0
  name: vMMSC_Service
  description: vMMSC Service
  type: Service
  category: Mobility
  ecompNaming: false
  homing: false

 # reference to template definitions
imports:
  - tosca_simple_profile_for_ecomp_1_0.yml
  - vmmsc_vf.yml
  - veca_oam_vf.yml
  - cmaui_vf.yml
  - service_network.yml # 

topology_template:
  
   # This section provides the parameters which OPENECOMP is not providing values to during instantiation.
   # It is expected that node template parameters which are not mapped to the Inputs section recieve value from OPENECOMP
   # during the orchestration

  inputes: 
    service_instance_name:
      type: string
      description: service instance name
    service_deployment_node:
      type: string
      description: The target LCP node for deployment of this service instance
    vMMSC_init_instances:
      type: integer
      description: The number of instances to instantiate
      constraints:
        - in_range: [1, 5]
    vECA_OAM_init_instances:
      type: integer
      description: The number of instances to instantiate
      constraints:
        - in_range: [1, 3]

  node_templates:

    vMMSC: # vMMSC VNF
      type: org.openecomp.resource.vf.Generic

      metadata:
        invariantUUID: b8643c59-e2c2-4f86-880d-571d4d9d5d22
        UUID: b020ed1e-4bc7-4fc0-ba7e-cc7af6da7ffc
        version: 1.0
        name: vMMC VF
        description: |
                              Delivers messages composed of text, images, and other media types (for example audio and video) 
                              in an operator's network. It is responsible for storing and handling incoming and outgoing Multimedia
                              Messages (MMs); therefore, acting as an MMS Relay and MMS Server at the same time.
        type: VF
        category: Mobility
        subCategory: MMC
        vendor: Nokia
        vendorVersion: 6.0.2.14

      properties:
        vf_ecomp_name: true
        vf_instance_name: # to be set by OPENECOMP during instantiation
        vf_homing: true
        vf_deployment_node: # to be set by OPENECOMP during instantiation
        min_instances: 1
        max_instances: 5
        init_instances:    # number of instances to initialize. This number can be in the range of min_instances and max_instances.
                           # if no value provided use min_instances value.


    vECA_OAM: # vECA VF
      type: org.openecomp.resource.vf.Generic

      metadata:
        invariantUUID: 3d4f3d68-d3a3-4f52-127c-ab188c9d4da2 # generated by ASDC
        UUID: a2c4dc32-9c16-a3df-d2c0-e5ab221c69f0 # generated by ASDC
        version: 1.0 # set by ASDC
        name: vECA VF
        description: |
                              Performs intelligent adaptation of Multimedia Messages (MMs), and adaptation of individual media, 
                              such as videos, audio files, images, animations, and text. Sits on the MM1 downlink path and performs
                              optimization offline. It intercepts the entire media and completes the optimizations before sending
                              the message to handsets.
        type: VF
        category: Mobility
        subCategory: MMSC
        vendor: Nokia
        vendorVersion: 13
      
      properties:
        vf_ecomp_name: true
        vf_instance_name: # to be set by OPENECOMP during instantiation
        vf_homing: true
        vf_deployment_node: # to be set by OPENECOMP during instantiation
        min_instances: 1
        max_instances: 3



    CMAUI: # CMAUI VF
      type: org.openecomp.resource.vf.Generic

      metadata:
        invariantUUID: dd4f3d68-1223-4a97-127c-11ab729d4da2 # generated by ASDC
        UUID: 2a14db52-5116-d3af-1240-1236221cab8d # generated by ASDC
        version: 1.0 # set by ASDC
        name: CMAUI VF
        description: CMAUI MMSC VF
        type: VF
        category: Mobility
        subCategory: MMSC
        vendor: Nokia
        vendorVersion: 5.0.2.5.37
      
      properties:
        vf_ecomp_name: true
        vf_instance_name: # to be set by OPENECOMP during instantiation
        vf_homing: true
        vf_deployment_node: # to be set by OPENECOMP during instantiation
        min_instances: 1 
        max_instances: 1



    # service level network

    eca_internal_net:
      type: abc.openecomp.resource.vl.VL
      metadata:
        invariantUUID: 89595c59-2134-4f86-880d-371d4d9d12a6
        UUID: 1af0ed2e-abcd-3f20-834e-cc7af4dafc45
        version: 1.0
        name: ECA traffic network
        description: ECA traffic network
        type: VL
        category: VL
        vendor: Nokia

      properties:
        network_type: Tenant_Layer_3
        network_technology: Contrail
        network_ecomp_name: false
        network_homing: false
        network_deployment_node: { get_input: network_deployment_node }
        contrail_virtual_network:
          network_name: # provided by OPENECOMP (SDNC)
          route_targets: 13979:105719
        network_id:
        layer_protocol: IP
        flow_pattern: E-LAN
        test_access: none
        l3_access_parameters:
          ip_version: 4
          cidr: 107.243.37.32/24 # HEAT ENV
          gateway_ip: 107.243.37.33 # HEAT ENV
          start_ip: 107.243.37.35 # HEAT ENV
          end_ip: 107.243.37.62 # HEAT ENV
      capabilities:
        virtual_linkable:
          valid_source_types: org.openecomp.resource.cp.CP

  groups:

    external_networks: # vMME_External_Network
      type: org.openecomp.groups.externalNetworks
      properties:
        contrail_service_instance: true # from HEAT
        availability_zone_count: 1 # from HEAT

      members: [ sctp_a_net, sctp_b_net, gtp_net ]