<!--
  ~ -
  ~  ============LICENSE_START=======================================================
  ~  Copyright (C) 2022 Nordix Foundation.
  ~  ================================================================================
  ~  Licensed under the Apache License, Version 2.0 (the "License");
  ~  you may not use this file except in compliance with the License.
  ~  You may obtain a copy of the License at
  ~
  ~       http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~  Unless required by applicable law or agreed to in writing, software
  ~  distributed under the License is distributed on an "AS IS" BASIS,
  ~  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~  See the License for the specific language governing permissions and
  ~  limitations under the License.
  ~
  ~  SPDX-License-Identifier: Apache-2.0
  ~  ============LICENSE_END=========================================================
  -->

<div class="app-constraints">
  <form novalidate class="w-sdc-form two-columns">
    <div class="w-sdc-form-columns-wrapper" *ngFor="let constraint of constraints">
        <div class="w-sdc-form-column-small">
          <div class="w-sdc-form-columns-wrapper">
            <div class="w-sdc-form-column-small">
              <span class="sprite-new delete-btn" [ngClass]="{'disabled': isViewOnly}" (click)="removeConstraint(constraint)"></span>
            </div>
            <div class="w-sdc-form-column">
              <select class="i-sdc-form-select"
                      data-tests-id="constraints"
                      [disabled]="isViewOnly"
                      (change)="changeConstraintType(constraint, $event.target.value)">
                <option *ngIf="constraint" [value]="constraint.type"
                        hidden selected>
                  {{ConstraintTypesMapping[constraint.type]}}
                </option>
                <option *ngFor="let constraintType of constraintTypes" [value]="constraintType">
                  {{ConstraintTypesMapping[constraintType]}}
                </option>
              </select>
            </div>
          </div>
        </div>
        <div class="w-sdc-form-column">
          <div class="w-sdc-form-columns-wrapper" *ngIf="constraint.type == 'inRange'">
            <div class="w-sdc-form-column">
              <input type="text" class="i-sdc-form-input myClass"
                    (change)="changeConstrainValueIndex(constraint, $event.target.value, 0)"
                    [disabled]="isViewOnly"
                    [value]="getInRangeValue(constraint, 0)"/>
            </div>
            <div class="w-sdc-form-column">
              <input type="text" class="i-sdc-form-input myClass"
                    (change)="changeConstrainValueIndex(constraint, $event.target.value, 1)"
                    [disabled]="isViewOnly"
                    [value]="getInRangeValue(constraint, 1)"/>
            </div>
          </div>
          <div *ngIf="constraint.type == 'validValues'">
            <div class="w-sdc-form-columns-wrapper-block">
              <div class="add-btn add-list-item w-sdc-form-column-block"
                   [ngClass]="{'disabled': isViewOnly}"
                   (click)="addToList(constraint)">Add to List</div>
            </div>
            <div class="w-sdc-form-columns-wrapper" *ngFor="let value of constraint.value; let i = index">
              <div class="w-sdc-form-column">
                <input type="text" class="i-sdc-form-input" [value]="value"
                       [disabled]="isViewOnly"
                       (change)="changeConstrainValueIndex(constraint, $event.target.value, i)"/>
              </div>
              <div class="w-sdc-form-column">
                <span class="sprite-new delete-btn" [ngClass]="{'disabled': isViewOnly}" (click)="removeFromList(constraint, value)"></span>
              </div>
            </div>
          </div>
          <div class="w-sdc-form-column" *ngIf="constraint.type != 'inRange' && constraint.type != 'validValues'">
            <input type="text" class="i-sdc-form-input myClass"
                  (change)="changeConstraintValue(constraint, $event.target.value)"
                  [value]="constraint.value"/>
          </div>
        </div>
    </div>
    <div class="w-sdc-form-columns-wrapper" *ngIf="!isViewOnly">
      <div class="w-sdc-form-column-small">
        <div class="w-sdc-form-columns-wrapper">
            <div class="add-btn add-list-item w-sdc-form-column-small"
                 [ngClass]="{'disabled': isViewOnly}"
                 (click)="addConstraint()">Add</div>

          <div class="w-sdc-form-column">
            <select class="i-sdc-form-select"
                    (change)="changeNewConstraintType($event.target.value)">
                <option *ngFor="let constraintType of constraintTypes" [value]="constraintType">
                  {{ConstraintTypesMapping[constraintType]}}
                </option>
              </select>
          </div>
        </div>
      </div>
      <div class="w-sdc-form-column">
        <div class="w-sdc-form-columns-wrapper" *ngIf="newConstraintType == 'inRange'">
          <div class="w-sdc-form-column">
            <input type="text" class="i-sdc-form-input" [value]="getNewInRangeValue(0)"
                 (change)="changeNewConstraintInRangeValue($event.target.value, 0)"/>
          </div>
          <div class="w-sdc-form-column">
            <input type="text" class="i-sdc-form-input" [value]="getNewInRangeValue(1)"
                 (change)="changeNewConstraintInRangeValue($event.target.value, 1)"/>
          </div>
        </div>


        <div class="w-sdc-form-columns-wrapper-block" *ngIf="newConstraintType == 'validValues'">
          <div class="w-sdc-form-columns-wrapper-block">
            <div class="add-btn add-list-item w-sdc-form-column-block"
                 (click)="addToNewList()">Add to List</div>
          </div>
          <div class="w-sdc-form-columns-wrapper" *ngFor="let value of newConstraintValue; let i = index;">
            <div class="w-sdc-form-column">
              <input type="text" class="i-sdc-form-input" [value]="value"
                     (change)="changeNewConstraintInRangeValue($event.target.value, i)"/>
            </div>
            <div class="w-sdc-form-column">
              <span class="sprite-new delete-btn" (click)="removeFromNewList(constraint, value)"></span>
            </div>
          </div>
        </div>
        <div class="w-sdc-form-columns-wrapper" *ngIf="newConstraintType != 'inRange' && newConstraintType != 'validValues'">
          <input type="text" class="i-sdc-form-input" [value]="newConstraintValue"
                 (change)="changeNewConstraintValue($event.target.value)"/>
        </div>
      </div>
    </div>

  </form>
</div>
