<!--
 * ============LICENSE_START=======================================================
 * SDC
 * ================================================================================
 * Copyright (C) 2021 Nordix Foundation. All rights reserved.
 * ================================================================================
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ============LICENSE_END=========================================================
-->

<div class="operation-handler">
    <loader [display]="isLoading" [size]="'large'" [relative]="true"></loader>

    <form class="w-sdc-form">

        <div class="side-by-side">
            <div class="form-item">
                <sdc-input
                    label="{{ 'OPERATION_INTERFACE_TYPE' | translate }}"
                    [(value)]="interfaceType"
                    [disabled]=isViewOnly>
                </sdc-input>
            </div>

            <div class="form-item">
                <sdc-input
                    label="{{ 'OPERATION_NAME' | translate }}"
                    [(value)]="operationToUpdate.name"
                    [disabled]=isViewOnly>
                </sdc-input>
            </div>
        </div>

        <div class="form-item">
            <sdc-input
                label="{{'OPERATION_DESCRIPTION' | translate}}"
                [(value)]="operationToUpdate.description"
                testId="interface-operation-description"
                (valueChange)="onDescriptionChange($event)"
                [disabled]=isViewOnly>
            </sdc-input>
        </div>

        <div class="group-with-border content-row">
            <label class="occurrences-label"> {{ 'INTERFACE_OPERATION_IMPLEMENTATION' | translate}}</label>
            <div class="form-item">
                <checkbox [label]="'Add Artifact To Implementation'"
                          [(checked)]="enableAddArtifactImplementation"
                          (checkedChange)="onMarkToAddArtifactToImplementation($event)"
                          [disabled]=isViewOnly>
                </checkbox>
            </div>
            <div class="form-item" *ngIf="!enableAddArtifactImplementation">
                <sdc-input
                    label="{{'INTERFACE_OPERATION_IMPLEMENTATION_NAME' | translate}}"
                    testId="interface-operation-implementation-name"
                    [(value)]="artifactName"
                    (valueChange)="onImplementationNameChange($event)"
                    [disabled]=isViewOnly>
                </sdc-input>
            </div>

            <div class="side-by-side" *ngIf="enableAddArtifactImplementation">
                <div class="form-item" *ngIf="toscaArtifactTypes">
                    <sdc-dropdown
                        label="{{ 'TOSCA_ARTIFACT_TYPE' | translate }}"
                        testId="selectToscaArtifactType"
                        [required]="true"
                        [selectedOption]="toscaArtifactTypeSelected"
                        placeHolder="{{toscaArtifactTypeSelected != undefined ? toscaArtifactTypeSelected : 'Select...'}}"
                        (changed)="onSelectToscaArtifactType($event)"
                        [options]="toscaArtifactTypes"
                        [disabled]=isViewOnly>
                    </sdc-dropdown>
                </div>
                <div class="form-item" *ngIf="toscaArtifactTypeSelected && enableAddArtifactImplementation">
                    <sdc-input
                        label="{{ 'INTERFACE_OPERATION_IMPLEMENTATION_FILE' | translate }}"
                        data-tests-id="artifactFile"
                        [(value)]="artifactName"
                        [required]="true"
                        (valueChange)="onArtifactFileChange($event)"
                        [disabled]=isViewOnly>
                    </sdc-input>
                </div>
                <div class="form-item">
                    <sdc-input
                        label="{{ 'ARTIFACT_VERSION' | translate }}"
                        data-tests-id="artifactVersion"
                        [(value)]="artifactVersion"
                        (valueChange)="onArtifactVersionChange($event)"
                        [disabled]=isViewOnly>
                    </sdc-input>
                </div>
            </div>
            <div class="form-item" *ngIf="toscaArtifactTypeSelected && enableAddArtifactImplementation">
                <label class="sdc-input__label">{{ 'ENTITY_VIEWER_PROPERTIES_TAB' | translate }}</label>
                <div class="generic-table">
                    <div class="header-row table-row">
                        <span class="cell header-cell field-input-name">{{ 'IMPLEMENTATION_ARTIFACT_PROPERTY_NAME' | translate }}</span>
                        <span class="cell header-cell field-input-type">{{ 'IMPLEMENTATION_ARTIFACT_PROPERTY_TYPE' | translate }}</span>
                        <span class="cell header-cell field-input-value">{{ 'IMPLEMENTATION_ARTIFACT_PROPERTY_VALUE' | translate }}</span>
                    </div>

                    <div class="empty-msg data-row" *ngIf="!toscaArtifactTypeProperties.length">
                        <div>{{ 'EMPTY_PARAM_TABLE_HEADER' | translate }}</div>
                    </div>
                    <property-param-row
                        *ngFor="let property of toscaArtifactTypeProperties"
                        class="data-row"
                        [artifactProperty]="property"
                        [isPropertyValueValid]="propertyValueValidation">
                    </property-param-row>
                </div>
            </div>
        </div>

        <div class="separator-buttons">
            <tab tabTitle="Inputs"></tab>
            <a class="add-param-link add-btn"
               [ngClass]="{'disabled': readonly || isViewOnly}"
               (click)="onAddInput()">{{'OPERATION_ADD_INPUT' | translate}}
            </a>
        </div>

        <div class="generic-table">
            <div class="header-row table-row">
                <span class="cell header-cell field-input-name">{{ 'OPERATION_PARAM_NAME' | translate }}</span>
                <span class="cell header-cell field-input-value">{{ 'OPERATION_INPUT_VALUE' | translate }}</span>
                <span class="cell header-cell remove">●●●</span>
            </div>
            <div class="empty-msg data-row" *ngIf="!inputs.length">
                <div>{{ 'OPERATION_INPUT_EMPTY' | translate }}</div>
            </div>
            <input-param-row
                *ngFor="let inputParameter of inputs"
                class="data-row"
                [input]="inputParameter"
                [onRemoveInput]="onRemoveInput"
                [validityChanged]="validityChanged">
            </input-param-row>
        </div>

    </form>
</div>
