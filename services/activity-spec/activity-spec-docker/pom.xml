<project xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns="http://maven.apache.org/POM/4.0.0"
  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>

  <groupId>org.openecomp.activityspec</groupId>
  <artifactId>setup</artifactId>
  <packaging>pom</packaging>

  <parent>
    <groupId>org.openecomp.activityspec</groupId>
    <artifactId>activity-spec</artifactId>
    <version>1.2.0-SNAPSHOT</version>
  </parent>

  <build>
      <plugins>
        <plugin>
          <groupId>io.fabric8</groupId>
          <artifactId>docker-maven-plugin</artifactId>
          <version>0.23.0</version>
          <configuration>
            <registry>nexus3.onap.org:10001</registry>
            <authConfig>
              <pull>
                <username>docker</username>
                <password>docker</password>
              </pull>
            </authConfig>
            <images>
                <image>
                  <name>activity-spec-init</name>
                  <build>
                    <tags>
                      <tag>${project.version}</tag>
                    </tags>
                    <dockerFileDir>${basedir}</dockerFileDir>
                    <dockerFile>activity-spec-init-Dockerfile</dockerFile>
                  </build>
                </image>
                <image>
                  <name>activity-spec-be</name>
                  <build>
                    <tags>
                      <tag>${project.version}</tag>
                    </tags>
                    <dockerFileDir>${basedir}</dockerFileDir>
                    <dockerFile>activity-spec-be-Dockerfile</dockerFile>
                  </build>
                </image>
            </images>
          </configuration>
          <executions>
            <execution>
              <id>docker-build</id>
              <phase>install</phase>
              <goals>
                <goal>build</goal>
              </goals>
            </execution>
            <execution>
              <id>push-images</id>
              <phase>deploy</phase>
              <goals>
                <goal>push</goal>
              </goals>
            </execution>
          </executions>
        </plugin>
        <!--delete temporary directory "deploy" after docker images are created -->
        <plugin>
          <artifactId>maven-clean-plugin</artifactId>
          <version>2.5</version>
          <executions>
            <execution>
              <id>auto-clean</id>
              <phase>install</phase>
              <goals>
                <goal>clean</goal>
              </goals>
              <configuration>
                <excludeDefaultDirectories>true</excludeDefaultDirectories>
                <filesets>
                  <fileset>
                    <directory>deploy</directory>
                  </fileset>
                </filesets>
              </configuration>
            </execution>
          </executions>
        </plugin>
      </plugins>
  </build>

</project>