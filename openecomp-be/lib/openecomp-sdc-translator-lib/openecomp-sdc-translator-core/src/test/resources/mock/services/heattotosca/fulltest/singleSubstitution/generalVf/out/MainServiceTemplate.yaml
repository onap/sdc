tosca_definitions_version: tosca_simple_yaml_1_0_0
metadata:
  template_name: Main
imports:
- openecomp_heat_index:
    file: openecomp-heat/_index.yml
- GlobalSubstitutionTypes:
    file: GlobalSubstitutionTypesServiceTemplate.yaml
topology_template:
  inputs:
    Internal2_name:
      hidden: false
      immutable: false
      type: string
      default: Internal2-subnet
    vlc2-Internal2-mac:
      hidden: false
      immutable: false
      type: string
      description: static mac address assigned to vlc2-Internal2
      default: 00:81:37:0E:02:12
    epc-sctp-a-net-rt:
      hidden: false
      immutable: false
      type: string
      description: epc-sctp-a route target
      default: 13979:105717
    epc-sctp-b-net-rt:
      hidden: false
      immutable: false
      type: string
      description: epc-sctp-b route target
      default: 13979:105719
    gpb-flavor:
      hidden: false
      immutable: false
      type: string
      description: Flavor to use for servers gpb
      default: m4.xlarge4
    Internal1_cidr:
      hidden: false
      immutable: false
      type: string
      default: 169.253.0.0/17
    epc-sctp-a-pool-start:
      hidden: false
      immutable: false
      type: string
      description: epc-sctp-a-net network ip pool start IP address
      default: 107.243.37.3
    Internal2_subnet_name:
      hidden: false
      immutable: false
      type: string
      default: vmme_int_int_sub_2
    Internal1_subnet_name:
      hidden: false
      immutable: false
      type: string
      default: vmme_int_int_sub_1
    gpb1-Internal1-mac:
      hidden: false
      immutable: false
      type: string
      description: static mac address assigned to gpb1-Internal1
      default: 00:80:37:0E:01:22
    gpb1-Internal1-ip:
      hidden: false
      immutable: false
      type: string
      default: 169.254.0.101
    FSB_1_image:
      label: MME_FSB1
      hidden: false
      immutable: false
      type: string
      description: MME_FSB1_15B-CP04-r5a01
      default: MME_FSB1_15B-CP04-r5a01
    fsb1-Internal2-mac:
      hidden: false
      immutable: false
      type: string
      description: static mac address assigned to fsb1-Internal2
      default: 00:81:37:0E:0B:12
    ncb_zone:
      hidden: false
      immutable: false
      type: string
      description: cluster for spawnning ncb instances
      default: nova
    Internal2_net_name:
      hidden: false
      immutable: false
      type: string
      default: vmme_int_int_2
    epc-sctp-a-pool-end:
      hidden: false
      immutable: false
      type: string
      description: epc-sctp-a-net network ip pool end IP address
      default: 107.243.37.30
    Internal1_name:
      hidden: false
      immutable: false
      type: string
      default: Internal1-subnet
    gpb2-name:
      hidden: false
      immutable: false
      type: string
      description: Name of gpb2
      default: ZRDM1MMEX33GPB002
    fsb2-Internal1-mac:
      hidden: false
      immutable: false
      type: string
      description: static mac address assigned to fsb2-Internal1
      default: 00:80:37:0E:0D:12
    fsb2-name:
      hidden: false
      immutable: false
      type: string
      description: Name of fsb1
      default: ZRDM1MMEX33FSB002
    static_prefix_sctp_b_1:
      hidden: false
      immutable: false
      type: string
      description: Static Prefix
      default: 107.239.40.64/30
    fsb2-oam-ip:
      hidden: false
      immutable: false
      type: string
      default: 107.250.172.222
    fsb2-flavor:
      hidden: false
      immutable: false
      type: string
      description: Flavor to use for servers  fsb2
      default: m4.xlarge4
    fsb2-Internal2-mac:
      hidden: false
      immutable: false
      type: string
      description: static mac address assigned to fsb2-Internal2
      default: 00:81:37:0E:0D:12
    ncb2-Internal1-mac:
      hidden: false
      immutable: false
      type: string
      description: static mac address assigned to ncb2-Internal1
      default: 00:80:37:0E:0F:12
    ncb2-name:
      hidden: false
      immutable: false
      type: string
      description: Name of ncb2
      default: ZRDM1MMEX33NCB002
    epc-sctp-b-pool-end:
      hidden: false
      immutable: false
      type: string
      description: epc-sctp-b-net network ip pool end IP address
      default: 107.243.37.62
    vlc1-gtp-ip:
      hidden: false
      immutable: false
      type: string
      default: 107.243.37.67
    epc-sctp-b-pool-start:
      hidden: false
      immutable: false
      type: string
      description: epc-sctp-b-net network ip pool start IP address
      default: 107.243.37.35
    Internal2_shared:
      hidden: false
      immutable: false
      type: string
      default: 'False'
    Internal1_net_name:
      hidden: false
      immutable: false
      type: string
      default: vmme_int_int_1
    vlc2-name:
      hidden: false
      immutable: false
      type: string
      description: Name of vlc2
      default: ZRDM1MMEX33VLC002
    Internal2_ipam_name:
      hidden: false
      immutable: false
      type: string
      default: vmme_ipam_int2
    vlc1-sctp-b-ip:
      hidden: false
      immutable: false
      type: string
      default: 107.243.37.35
    Internal1_net_pool_end:
      hidden: false
      immutable: false
      type: string
      default: 169.253.0.254
    Internal1_default_gateway:
      hidden: false
      immutable: false
      type: string
      default: 169.253.0.3
    ncb1-Internal1-mac:
      hidden: false
      immutable: false
      type: string
      description: static mac address assigned to ncb1-Internal1
      default: 00:80:37:0E:09:12
    epc-gtp-net-name:
      hidden: false
      immutable: false
      type: string
      description: gtp net name
      default: EPC-GTP
    vlc1-Internal1-mac:
      hidden: false
      immutable: false
      type: string
      description: static mac address assigned to vlc1-Internal1
      default: 00:80:37:0E:01:12
    gpb2-Internal1-mac:
      hidden: false
      immutable: false
      type: string
      description: static mac address assigned to gpb2-Internal1
      default: 00:80:37:0E:02:22
    epc-gtp-net-cidr:
      hidden: false
      immutable: false
      type: string
      description: gtp stubnet
      default: 107.243.37.64/27
    oam_net_id:
      hidden: false
      immutable: false
      type: string
      description: uuid of oam network
      default: 47bf4cca-0961-422f-bcd6-d5a4fbb1a351
    vlc_zone:
      hidden: false
      immutable: false
      type: string
      description: cluster for spawnning vlc instances
      default: nova
    vlc2-Internal1-mac:
      hidden: false
      immutable: false
      type: string
      description: static mac address assigned to vlc2-Internal1
      default: 00:80:37:0E:02:12
    epc-sctp-a-net-cidr:
      hidden: false
      immutable: false
      type: string
      description: epc-sctp-a subnet
      default: 107.243.37.0/27
    Internal1_forwarding_mode:
      hidden: false
      immutable: false
      type: string
      default: l2
    Internal2_dhcp:
      hidden: false
      immutable: false
      type: boolean
      default: false
    fsb1-oam-ip:
      hidden: false
      immutable: false
      type: string
      default: 107.250.172.221
    FSB_2_image:
      label: MME_FSB2
      hidden: false
      immutable: false
      type: string
      description: MME_FSB2_15B-CP04-r5a01
      default: MME_FSB2_15B-CP04-r5a01
    vlc1-oam-ip:
      hidden: false
      immutable: false
      type: string
      default: 107.250.172.227
    epc-sctp-a-net-name:
      hidden: false
      immutable: false
      type: string
      description: epc-sctp-a net name
      default: EPC-SCTP-A
    vlc2-oam-ip:
      hidden: false
      immutable: false
      type: string
      default: 107.250.172.228
    Internal2_net_pool_start:
      hidden: false
      immutable: false
      type: string
      default: 169.255.0.100
    FSB1_volume_name:
      label: FSB1_volume
      hidden: false
      immutable: false
      type: string
      description: FSB1_volume_1
      default: vFSB1_1_Vol_1
    vlc1-sctp-a-ip:
      hidden: false
      immutable: false
      type: string
      default: 107.243.37.3
    Internal1_ipam_name:
      hidden: false
      immutable: false
      type: string
      default: vmme_ipam_int1
    Internal1_dhcp:
      hidden: false
      immutable: false
      type: boolean
      default: false
    Internal2_external:
      hidden: false
      immutable: false
      type: string
      default: 'False'
    Internal2_forwarding_mode:
      hidden: false
      immutable: false
      type: string
      default: l2
    vlc1-name:
      hidden: false
      immutable: false
      type: string
      description: Name of vlc1
      default: ZRDM1MMEX33VLC002
    vlc-flavor:
      hidden: false
      immutable: false
      type: string
      description: Flavor to use for servers vlc
      default: m4.xlarge4
    epc-gtp-net-rt:
      hidden: false
      immutable: false
      type: string
      description: gtp route target
      default: 13979:105715
    gpb_zone:
      hidden: false
      immutable: false
      type: string
      description: cluster for spawnning gpb instances
      default: nova
    gpb1-Internal2-mac:
      hidden: false
      immutable: false
      type: string
      description: static mac address assigned to gpb1-Internal2
      default: 00:81:37:0E:01:22
    fsb1-Internal1-mac:
      hidden: false
      immutable: false
      type: string
      description: static mac address assigned to fsb1-Internal1
      default: 00:80:37:0E:0B:12
    FSB2_volume_name:
      label: FSB2_volume
      hidden: false
      immutable: false
      type: string
      description: FSB2_volume_1
      default: vFSB2_1_Vol_1
    VMME_FSB2_boot_volume:
      hidden: false
      immutable: false
      type: string
      default: 089a0d11-4b15-4370-8343-3f90907b1221
    fsb_zone:
      hidden: false
      immutable: false
      type: string
      description: cluster for spawnning fsb instances
      default: nova
    VMME_FSB1_boot_volume:
      hidden: false
      immutable: false
      type: string
      default: 8248e794-6173-4b49-b9c3-8219b0b56f4e
    Internal2_default_gateway:
      hidden: false
      immutable: false
      type: string
      default: 169.255.0.3
    Internal1_external:
      hidden: false
      immutable: false
      type: string
      default: 'False'
    vlc2-sctp-a-ip:
      hidden: false
      immutable: false
      type: string
      default: 107.243.37.4
    ncb-flavor:
      hidden: false
      immutable: false
      type: string
      description: Flavor to use for servers ncb
      default: m4.xlarge4
    Internal1_shared:
      hidden: false
      immutable: false
      type: string
      default: 'False'
    fsb1-name:
      hidden: false
      immutable: false
      type: string
      description: Name of fsb1
      default: ZRDM1MMEX33FSB001
    static_prefix_gtp_1:
      hidden: false
      immutable: false
      type: string
      description: Static Prefix
      default: 107.239.40.96/30
    epc-sctp-b-net-gateway:
      hidden: false
      immutable: false
      type: string
      description: epc-sctp-b-net network gateway
      default: 107.243.37.33
    epc-sctp-b-net-cidr:
      hidden: false
      immutable: false
      type: string
      description: epc-sctp-b subnet
      default: 107.243.37.32/24
    epc-gtp-pool-end:
      hidden: false
      immutable: false
      type: string
      description: gtp network ip pool end IP address
      default: 107.243.37.94
    epc-sctp-a-net-gateway:
      hidden: false
      immutable: false
      type: string
      description: epc-sctp-a-net network gateway
      default: 107.243.37.1
    vlc2-gtp-ip:
      hidden: false
      immutable: false
      type: string
      default: 107.243.37.68
    vlc2-sctp-b-ip:
      hidden: false
      immutable: false
      type: string
      default: 107.243.37.36
    Internal1_net_pool_start:
      hidden: false
      immutable: false
      type: string
      default: 169.253.0.100
    volume_size:
      label: volume size
      hidden: false
      immutable: false
      type: float
      description: my volume size 320GB
      default: 320
    fsb2-image:
      hidden: false
      immutable: false
      type: string
      description: Name of image to use for server fsb2
      default: MME_FSB2_15B-CP04-r5a01
    ncb2-Internal2-mac:
      hidden: false
      immutable: false
      type: string
      description: static mac address assigned to ncb2-Internal2
      default: 00:81:37:0E:0F:12
    ncb1-name:
      hidden: false
      immutable: false
      type: string
      description: Name of ncb1
      default: ZRDM1MMEX33NCB001
    fsb1-image:
      hidden: false
      immutable: false
      type: string
      description: Name of image to use for server fsb1
      default: MME_FSB1_15B-CP04-r5a01
    fsb1-flavor:
      hidden: false
      immutable: false
      type: string
      description: Flavor to use for servers  fsb1
      default: m4.xlarge4
    volume_type:
      label: volume type
      hidden: false
      immutable: false
      type: string
      description: volume type Gold
      default: Gold
    Internal2_net_pool_end:
      hidden: false
      immutable: false
      type: string
      default: 169.255.0.254
    epc-sctp-b-net-name:
      hidden: false
      immutable: false
      type: string
      description: epc-sctp-b net name
      default: EPC-SCTP-B
    Internal2_cidr:
      hidden: false
      immutable: false
      type: string
      default: 169.255.0.0/17
    epc-gtp-net-gateway:
      hidden: false
      immutable: false
      type: string
      description: gtp network gateway
      default: 107.243.37.65
    gpb2-Internal2-mac:
      hidden: false
      immutable: false
      type: string
      description: static mac address assigned to gpb2-Internal2
      default: 00:81:37:0E:02:22
    ncb1-Internal2-mac:
      hidden: false
      immutable: false
      type: string
      description: static mac address assigned to ncb1-Internal2
      default: 00:81:37:0E:09:12
    epc-gtp-pool-start:
      hidden: false
      immutable: false
      type: string
      description: gtp network ip pool start IP address
      default: 107.243.37.67
    static_prefix_sctp_a_1:
      hidden: false
      immutable: false
      type: string
      description: Static Prefix
      default: 107.239.40.32/30
    gpb1-name:
      hidden: false
      immutable: false
      type: string
      description: Name of gpb1
      default: ZRDM1MMEX33GPB001
    pxe-image:
      hidden: false
      immutable: false
      type: string
      description: Name of image to use for server ncb
      default: MME_PXE-BOOT_cxp9025898_2r5a01.qcow2
    vlc1-Internal2-mac:
      hidden: false
      immutable: false
      type: string
      description: static mac address assigned to vlc1-Internal2
      default: 00:81:37:0E:01:12
  node_templates:
    epc-gtp-net:
      type: org.openecomp.resource.vl.nodes.heat.network.contrail.VirtualNetwork
      properties:
        route_targets:
        - get_input: epc-gtp-net-rt
        network_name:
          get_input: epc-gtp-net-name
        subnets:
          epc-gtp-subnet:
            cidr:
              get_input: epc-gtp-net-cidr
            gateway_ip:
              get_input: epc-gtp-net-gateway
            allocation_pools:
            - start:
                get_input: epc-gtp-pool-start
              end:
                get_input: epc-gtp-pool-end
    FSB1_volume:
      type: org.openecomp.resource.vfc.nodes.heat.cinder.Volume
      properties:
        image:
          get_input: FSB_1_image
        volume_type:
          get_input: volume_type
        size: '(get_input : volume_size) * 1024'
        name:
          get_input: FSB1_volume_name
    FSB2_volume:
      type: org.openecomp.resource.vfc.nodes.heat.cinder.Volume
      properties:
        image:
          get_input: FSB_2_image
        volume_type:
          get_input: volume_type
        size: '(get_input : volume_size) * 1024'
        name:
          get_input: FSB2_volume_name
    abstract_VLC2:
      type: org.openecomp.resource.abstract.nodes.VLC2
      directives:
      - substitutable
      properties:
        port_VLC_SCTP_A_network:
        - epc-sctp-a-net
        port_VLC_OAM_network_role_tag:
        - oam
        port_VLC_GTP_ip_requirements:
        - - ip_version: 4
            ip_count_required:
              is_required: true
            floating_ip_count_required:
              is_required: false
        port_VLC2_Internal2_ip_requirements:
        - - ip_version: 4
            ip_count_required:
              is_required: false
            floating_ip_count_required:
              is_required: false
        port_VLC_SCTP_A_mac_requirements:
        - mac_count_required:
            is_required: false
        vm_flavor_name:
          get_input: vlc-flavor
        port_VLC_SCTP_B_ip_requirements:
        - - ip_version: 4
            ip_count_required:
              is_required: true
            floating_ip_count_required:
              is_required: false
        port_VLC_SCTP_A_fixed_ips:
        - - ip_address:
              get_input: vlc2-sctp-a-ip
        port_VLC_OAM_ip_requirements:
        - - ip_version: 4
            ip_count_required:
              is_required: true
            floating_ip_count_required:
              is_required: false
        port_VLC2_Internal2_mac_address:
        - get_input: vlc2-Internal2-mac
        port_VLC_OAM_fixed_ips:
        - - ip_address:
              get_input: vlc2-oam-ip
        vm_image_name:
          get_input: pxe-image
        port_VLC2_Internal1_mac_address:
        - get_input: vlc2-Internal1-mac
        port_VLC2_Internal2_mac_requirements:
        - mac_count_required:
            is_required: true
        port_VLC2_Internal1_mac_requirements:
        - mac_count_required:
            is_required: true
        port_VLC_SCTP_A_ip_requirements:
        - - ip_version: 4
            ip_count_required:
              is_required: true
            floating_ip_count_required:
              is_required: false
        port_VLC_SCTP_B_network:
        - epc-sctp-b-net
        port_VLC_GTP_network:
        - epc-gtp-net
        port_VLC2_Internal1_ip_requirements:
        - - ip_version: 4
            ip_count_required:
              is_required: false
            floating_ip_count_required:
              is_required: false
        compute_VLC2_name:
        - get_input: vlc2-name
        port_VLC_SCTP_B_fixed_ips:
        - - ip_address:
              get_input: vlc2-sctp-b-ip
        port_VLC_GTP_mac_requirements:
        - mac_count_required:
            is_required: false
        port_VLC2_Internal1_network:
        - Internal1-net
        compute_VLC2_availability_zone:
        - get_input: vlc_zone
        port_VLC_GTP_fixed_ips:
        - - ip_address:
              get_input: vlc2-gtp-ip
        port_VLC_OAM_mac_requirements:
        - mac_count_required:
            is_required: false
        port_VLC_OAM_network:
        - get_input: oam_net_id
        port_VLC_SCTP_B_mac_requirements:
        - mac_count_required:
            is_required: false
        port_VLC2_Internal2_network:
        - Internal2-net
        service_template_filter:
          substitute_service_template: Nested_VLC2ServiceTemplate.yaml
          count: 1
        index_value:
          get_property:
          - SELF
          - service_template_filter
          - index_value
      requirements:
      - link_VLC2_VLC2_Internal1:
          capability: tosca.capabilities.network.Linkable
          node: Internal1-net
          relationship: tosca.relationships.network.LinksTo
      - link_VLC2_VLC2_Internal2:
          capability: tosca.capabilities.network.Linkable
          node: Internal2-net
          relationship: tosca.relationships.network.LinksTo
      - link_VLC2_VLC_SCTP_B:
          capability: tosca.capabilities.network.Linkable
          node: epc-sctp-b-net
          relationship: tosca.relationships.network.LinksTo
      - link_VLC2_VLC_SCTP_A:
          capability: tosca.capabilities.network.Linkable
          node: epc-sctp-a-net
          relationship: tosca.relationships.network.LinksTo
      - link_VLC2_VLC_GTP:
          capability: tosca.capabilities.network.Linkable
          node: epc-gtp-net
          relationship: tosca.relationships.network.LinksTo
    abstract_VLC1:
      type: org.openecomp.resource.abstract.nodes.VLC1
      directives:
      - substitutable
      properties:
        port_VLC1_Internal2_mac_address:
        - get_input: vlc1-Internal2-mac
        port_VLC1_Internal1_network:
        - Internal1-net
        port_VLC_SCTP_A_network:
        - epc-sctp-a-net
        port_VLC_OAM_network_role_tag:
        - oam
        port_VLC1_Internal1_mac_address:
        - get_input: vlc1-Internal1-mac
        port_VLC_GTP_ip_requirements:
        - - ip_version: 4
            ip_count_required:
              is_required: true
            floating_ip_count_required:
              is_required: false
        port_VLC_SCTP_A_mac_requirements:
        - mac_count_required:
            is_required: false
        vm_flavor_name:
          get_input: vlc-flavor
        port_VLC1_Internal2_network:
        - Internal2-net
        port_VLC_SCTP_B_ip_requirements:
        - - ip_version: 4
            ip_count_required:
              is_required: true
            floating_ip_count_required:
              is_required: false
        port_VLC_SCTP_A_fixed_ips:
        - - ip_address:
              get_input: vlc1-sctp-a-ip
        port_VLC_OAM_ip_requirements:
        - - ip_version: 4
            ip_count_required:
              is_required: true
            floating_ip_count_required:
              is_required: false
        port_VLC1_Internal1_ip_requirements:
        - - ip_version: 4
            ip_count_required:
              is_required: false
            floating_ip_count_required:
              is_required: false
        port_VLC_OAM_fixed_ips:
        - - ip_address:
              get_input: vlc1-oam-ip
        vm_image_name:
          get_input: pxe-image
        port_VLC_SCTP_A_ip_requirements:
        - - ip_version: 4
            ip_count_required:
              is_required: true
            floating_ip_count_required:
              is_required: false
        port_VLC_SCTP_B_network:
        - epc-sctp-b-net
        port_VLC_GTP_network:
        - epc-gtp-net
        compute_VLC1_availability_zone:
        - get_input: vlc_zone
        port_VLC1_Internal1_mac_requirements:
        - mac_count_required:
            is_required: true
        port_VLC1_Internal2_mac_requirements:
        - mac_count_required:
            is_required: true
        port_VLC_SCTP_B_fixed_ips:
        - - ip_address:
              get_input: vlc1-sctp-b-ip
        port_VLC_GTP_mac_requirements:
        - mac_count_required:
            is_required: false
        port_VLC_GTP_fixed_ips:
        - - ip_address:
              get_input: vlc1-gtp-ip
        port_VLC_OAM_mac_requirements:
        - mac_count_required:
            is_required: false
        port_VLC_OAM_network:
        - get_input: oam_net_id
        compute_VLC1_name:
        - get_input: vlc1-name
        port_VLC_SCTP_B_mac_requirements:
        - mac_count_required:
            is_required: false
        port_VLC1_Internal2_ip_requirements:
        - - ip_version: 4
            ip_count_required:
              is_required: false
            floating_ip_count_required:
              is_required: false
        service_template_filter:
          substitute_service_template: Nested_VLC1ServiceTemplate.yaml
          count: 1
        index_value:
          get_property:
          - SELF
          - service_template_filter
          - index_value
      requirements:
      - link_VLC1_VLC1_Internal1:
          capability: tosca.capabilities.network.Linkable
          node: Internal1-net
          relationship: tosca.relationships.network.LinksTo
      - link_VLC1_VLC1_Internal2:
          capability: tosca.capabilities.network.Linkable
          node: Internal2-net
          relationship: tosca.relationships.network.LinksTo
      - link_VLC1_VLC_SCTP_B:
          capability: tosca.capabilities.network.Linkable
          node: epc-sctp-b-net
          relationship: tosca.relationships.network.LinksTo
      - link_VLC1_VLC_SCTP_A:
          capability: tosca.capabilities.network.Linkable
          node: epc-sctp-a-net
          relationship: tosca.relationships.network.LinksTo
      - link_VLC1_VLC_GTP:
          capability: tosca.capabilities.network.Linkable
          node: epc-gtp-net
          relationship: tosca.relationships.network.LinksTo
    Internal1-net:
      type: org.openecomp.resource.vl.nodes.heat.network.contrail.VirtualNetwork
      properties:
        dhcp_enabled:
          get_input: Internal1_dhcp
        shared:
          get_input: Internal1_shared
        forwarding_mode:
          get_input: Internal1_forwarding_mode
        external:
          get_input: Internal1_external
        network_name:
          get_input: Internal1_net_name
        subnets:
          Internal1-subnet:
            enable_dhcp:
              get_input: Internal1_dhcp
            cidr:
              get_input: Internal1_cidr
            gateway_ip:
              get_input: Internal1_default_gateway
    abstract_GPB1:
      type: org.openecomp.resource.abstract.nodes.GPB1
      directives:
      - substitutable
      properties:
        port_GPB1_Internal2_network:
        - Internal2-net
        port_GPB1_Internal1_network:
        - Internal1-net
        compute_GPB1_name:
        - get_input: gpb1-name
        vm_flavor_name:
          get_input: gpb-flavor
        port_GPB1_Internal2_mac_requirements:
        - mac_count_required:
            is_required: true
        port_GPB1_Internal1_mac_address:
        - get_input: gpb1-Internal1-mac
        port_GPB1_Internal2_mac_address:
        - get_input: gpb1-Internal2-mac
        vm_image_name:
          get_input: pxe-image
        port_GPB1_Internal1_ip_requirements:
        - - ip_version: 4
            ip_count_required:
              is_required: false
            floating_ip_count_required:
              is_required: false
        port_GPB1_Internal1_mac_requirements:
        - mac_count_required:
            is_required: true
        compute_GPB1_availability_zone:
        - get_input: gpb_zone
        port_GPB1_Internal2_ip_requirements:
        - - ip_version: 4
            ip_count_required:
              is_required: false
            floating_ip_count_required:
              is_required: false
        service_template_filter:
          substitute_service_template: Nested_GPB1ServiceTemplate.yaml
          count: 1
        index_value:
          get_property:
          - SELF
          - service_template_filter
          - index_value
      requirements:
      - link_GPB1_GPB1_Internal1:
          capability: tosca.capabilities.network.Linkable
          node: Internal1-net
          relationship: tosca.relationships.network.LinksTo
      - link_GPB1_GPB1_Internal2:
          capability: tosca.capabilities.network.Linkable
          node: Internal2-net
          relationship: tosca.relationships.network.LinksTo
    abstract_GPB2:
      type: org.openecomp.resource.abstract.nodes.GPB2
      directives:
      - substitutable
      properties:
        port_GPB2_Internal2_mac_address:
        - get_input: gpb2-Internal2-mac
        port_GPB2_Internal2_mac_requirements:
        - mac_count_required:
            is_required: true
        port_GPB2_Internal1_ip_requirements:
        - - ip_version: 4
            ip_count_required:
              is_required: false
            floating_ip_count_required:
              is_required: false
        port_GPB2_Internal1_network:
        - Internal1-net
        compute_GPB2_availability_zone:
        - get_input: gpb_zone
        vm_flavor_name:
          get_input: gpb-flavor
        port_GPB2_Internal1_mac_requirements:
        - mac_count_required:
            is_required: true
        port_GPB2_Internal2_ip_requirements:
        - - ip_version: 4
            ip_count_required:
              is_required: false
            floating_ip_count_required:
              is_required: false
        vm_image_name:
          get_input: pxe-image
        compute_GPB2_name:
        - get_input: gpb2-name
        port_GPB2_Internal1_mac_address:
        - get_input: gpb2-Internal1-mac
        port_GPB2_Internal2_network:
        - Internal2-net
        service_template_filter:
          substitute_service_template: Nested_GPB2ServiceTemplate.yaml
          count: 1
        index_value:
          get_property:
          - SELF
          - service_template_filter
          - index_value
      requirements:
      - link_GPB2_GPB2_Internal1:
          capability: tosca.capabilities.network.Linkable
          node: Internal1-net
          relationship: tosca.relationships.network.LinksTo
      - link_GPB2_GPB2_Internal2:
          capability: tosca.capabilities.network.Linkable
          node: Internal2-net
          relationship: tosca.relationships.network.LinksTo
    Internal2-net:
      type: org.openecomp.resource.vl.nodes.heat.network.contrail.VirtualNetwork
      properties:
        dhcp_enabled:
          get_input: Internal2_dhcp
        shared:
          get_input: Internal2_shared
        forwarding_mode:
          get_input: Internal2_forwarding_mode
        external:
          get_input: Internal2_external
        network_name:
          get_input: Internal2_name
        subnets:
          Internal2-subnet:
            enable_dhcp:
              get_input: Internal2_dhcp
            cidr:
              get_input: Internal2_cidr
            gateway_ip:
              get_input: Internal2_default_gateway
    epc-sctp-a-net:
      type: org.openecomp.resource.vl.nodes.heat.network.contrail.VirtualNetwork
      properties:
        route_targets:
        - get_input: epc-sctp-a-net-rt
        network_name:
          get_input: epc-sctp-a-net-name
        subnets:
          epc-sctp-a-subnet:
            cidr:
              get_input: epc-sctp-a-net-cidr
            gateway_ip:
              get_input: epc-sctp-a-net-gateway
            allocation_pools:
            - start:
                get_input: epc-sctp-a-pool-start
              end:
                get_input: epc-sctp-a-pool-end
    abstract_NCB1:
      type: org.openecomp.resource.abstract.nodes.NCB1
      directives:
      - substitutable
      properties:
        port_NCB1_Internal2_mac_address:
        - get_input: ncb1-Internal2-mac
        port_NCB1_Internal1_mac_address:
        - get_input: ncb1-Internal1-mac
        port_NCB1_Internal1_ip_requirements:
        - - ip_version: 4
            ip_count_required:
              is_required: false
            floating_ip_count_required:
              is_required: false
        vm_flavor_name:
          get_input: ncb-flavor
        compute_NCB1_name:
        - get_input: ncb1-name
        port_NCB1_Internal1_mac_requirements:
        - mac_count_required:
            is_required: true
        port_NCB1_Internal2_mac_requirements:
        - mac_count_required:
            is_required: true
        port_NCB1_Internal1_network:
        - Internal1-net
        compute_NCB1_availability_zone:
        - get_input: ncb_zone
        vm_image_name:
          get_input: pxe-image
        port_NCB1_Internal2_ip_requirements:
        - - ip_version: 4
            ip_count_required:
              is_required: false
            floating_ip_count_required:
              is_required: false
        port_NCB1_Internal2_network:
        - Internal2-net
        service_template_filter:
          substitute_service_template: Nested_NCB1ServiceTemplate.yaml
          count: 1
        index_value:
          get_property:
          - SELF
          - service_template_filter
          - index_value
      requirements:
      - link_NCB1_NCB1_Internal1:
          capability: tosca.capabilities.network.Linkable
          node: Internal1-net
          relationship: tosca.relationships.network.LinksTo
      - link_NCB1_NCB1_Internal2:
          capability: tosca.capabilities.network.Linkable
          node: Internal2-net
          relationship: tosca.relationships.network.LinksTo
    abstract_NCB2:
      type: org.openecomp.resource.abstract.nodes.NCB2
      directives:
      - substitutable
      properties:
        port_NCB2_Internal1_network:
        - Internal1-net
        compute_NCB2_availability_zone:
        - get_input: ncb_zone
        port_NCB2_Internal2_ip_requirements:
        - - ip_version: 4
            ip_count_required:
              is_required: false
            floating_ip_count_required:
              is_required: false
        vm_flavor_name:
          get_input: ncb-flavor
        port_NCB2_Internal2_mac_requirements:
        - mac_count_required:
            is_required: true
        port_NCB2_Internal2_network:
        - Internal2-net
        port_NCB2_Internal1_mac_requirements:
        - mac_count_required:
            is_required: true
        port_NCB2_Internal1_mac_address:
        - get_input: ncb2-Internal1-mac
        port_NCB2_Internal2_mac_address:
        - get_input: ncb2-Internal2-mac
        vm_image_name:
          get_input: pxe-image
        compute_NCB2_name:
        - get_input: ncb2-name
        port_NCB2_Internal1_ip_requirements:
        - - ip_version: 4
            ip_count_required:
              is_required: false
            floating_ip_count_required:
              is_required: false
        service_template_filter:
          substitute_service_template: Nested_NCB2ServiceTemplate.yaml
          count: 1
        index_value:
          get_property:
          - SELF
          - service_template_filter
          - index_value
      requirements:
      - link_NCB2_NCB2_Internal1:
          capability: tosca.capabilities.network.Linkable
          node: Internal1-net
          relationship: tosca.relationships.network.LinksTo
      - link_NCB2_NCB2_Internal2:
          capability: tosca.capabilities.network.Linkable
          node: Internal2-net
          relationship: tosca.relationships.network.LinksTo
    epc-sctp-b-net:
      type: org.openecomp.resource.vl.nodes.heat.network.contrail.VirtualNetwork
      properties:
        route_targets:
        - get_input: epc-sctp-b-net-rt
        network_name:
          get_input: epc-sctp-b-net-name
        subnets:
          epc-sctp-b-subnet:
            cidr:
              get_input: epc-sctp-b-net-cidr
            gateway_ip:
              get_input: epc-sctp-b-net-gateway
            allocation_pools:
            - start:
                get_input: epc-sctp-b-pool-start
              end:
                get_input: epc-sctp-b-pool-end
    abstract_FSB1:
      type: org.openecomp.resource.abstract.nodes.FSB1
      directives:
      - substitutable
      properties:
        port_FSB1_Internal1_mac_address:
        - get_input: fsb1-Internal1-mac
        port_FSB_OAM_network_role_tag:
        - oam
        port_FSB1_Internal2_network:
        - Internal2-net
        port_FSB_OAM_mac_requirements:
        - mac_count_required:
            is_required: false
        compute_FSB1_availability_zone:
        - get_input: fsb_zone
        port_FSB1_Internal1_network:
        - Internal1-net
        vm_flavor_name:
          get_input: fsb1-flavor
        port_FSB1_Internal2_mac_address:
        - get_input: fsb1-Internal2-mac
        port_FSB_OAM_ip_requirements:
        - - ip_version: 4
            ip_count_required:
              is_required: true
            floating_ip_count_required:
              is_required: false
        port_FSB1_Internal2_mac_requirements:
        - mac_count_required:
            is_required: true
        port_FSB1_Internal2_ip_requirements:
        - - ip_version: 4
            ip_count_required:
              is_required: false
            floating_ip_count_required:
              is_required: false
        port_FSB_OAM_fixed_ips:
        - - ip_address:
              get_input: fsb1-oam-ip
        compute_FSB1_name:
        - get_input: fsb1-name
        port_FSB1_Internal1_mac_requirements:
        - mac_count_required:
            is_required: true
        port_FSB1_Internal1_ip_requirements:
        - - ip_version: 4
            ip_count_required:
              is_required: false
            floating_ip_count_required:
              is_required: false
        port_FSB_OAM_network:
        - get_input: oam_net_id
        service_template_filter:
          substitute_service_template: Nested_FSB1ServiceTemplate.yaml
          count: 1
        index_value:
          get_property:
          - SELF
          - service_template_filter
          - index_value
      requirements:
      - link_FSB1_FSB1_Internal1:
          capability: tosca.capabilities.network.Linkable
          node: Internal1-net
          relationship: tosca.relationships.network.LinksTo
      - link_FSB1_FSB1_Internal2:
          capability: tosca.capabilities.network.Linkable
          node: Internal2-net
          relationship: tosca.relationships.network.LinksTo
    abstract_FSB2:
      type: org.openecomp.resource.abstract.nodes.FSB2
      directives:
      - substitutable
      properties:
        port_FSB_OAM_network_role_tag:
        - oam
        port_FSB2_Internal2_mac_requirements:
        - mac_count_required:
            is_required: true
        port_FSB_OAM_mac_requirements:
        - mac_count_required:
            is_required: false
        port_FSB2_Internal2_ip_requirements:
        - - ip_version: 4
            ip_count_required:
              is_required: false
            floating_ip_count_required:
              is_required: false
        port_FSB2_Internal2_network:
        - Internal2-net
        vm_flavor_name:
          get_input: fsb2-flavor
        compute_FSB2_availability_zone:
        - get_input: fsb_zone
        port_FSB_OAM_ip_requirements:
        - - ip_version: 4
            ip_count_required:
              is_required: true
            floating_ip_count_required:
              is_required: false
        port_FSB2_Internal1_ip_requirements:
        - - ip_version: 4
            ip_count_required:
              is_required: false
            floating_ip_count_required:
              is_required: false
        compute_FSB2_name:
        - get_input: fsb2-name
        port_FSB2_Internal1_mac_address:
        - get_input: fsb2-Internal1-mac
        port_FSB_OAM_fixed_ips:
        - - ip_address:
              get_input: fsb2-oam-ip
        port_FSB2_Internal1_mac_requirements:
        - mac_count_required:
            is_required: true
        port_FSB_OAM_network:
        - get_input: oam_net_id
        port_FSB2_Internal1_network:
        - Internal1-net
        port_FSB2_Internal2_mac_address:
        - get_input: fsb2-Internal2-mac
        service_template_filter:
          substitute_service_template: Nested_FSB2ServiceTemplate.yaml
          count: 1
        index_value:
          get_property:
          - SELF
          - service_template_filter
          - index_value
      requirements:
      - link_FSB2_FSB2_Internal1:
          capability: tosca.capabilities.network.Linkable
          node: Internal1-net
          relationship: tosca.relationships.network.LinksTo
      - link_FSB2_FSB2_Internal2:
          capability: tosca.capabilities.network.Linkable
          node: Internal2-net
          relationship: tosca.relationships.network.LinksTo
  groups:
    vmme_small_group:
      type: org.openecomp.groups.heat.HeatStack
      properties:
        heat_file: ../Artifacts/vmme_small.yml
        description: HOT template to create vmme 2 fsb 2 ncb 2 gbp 2 vlc
      members:
      - epc-gtp-net
      - Internal1-net
      - Internal2-net
      - epc-sctp-a-net
      - epc-sctp-b-net
      - abstract_NCB1
      - abstract_GPB2
      - abstract_NCB2
      - abstract_GPB1
      - abstract_FSB2
      - abstract_VLC1
      - abstract_FSB1
      - abstract_VLC2
    vmme_small_create_fsb_group:
      type: org.openecomp.groups.heat.HeatStack
      properties:
        heat_file: ../Artifacts/vmme_small_create_fsb.yml
        description: server template for vMME
      members:
      - FSB1_volume
      - FSB2_volume